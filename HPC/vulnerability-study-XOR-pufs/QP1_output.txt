Conda uses environments to load different sets of Python packages
type conda env list to see the environments availible.
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
22/05/12 09:03:48 INFO SparkContext: Running Spark version 3.2.1
22/05/12 09:03:48 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
22/05/12 09:03:48 WARN SparkConf: Note that spark.local.dir will be overridden by the value set by the cluster manager (via SPARK_LOCAL_DIRS in mesos/standalone/kubernetes and LOCAL_DIRS in YARN).
22/05/12 09:03:48 INFO ResourceUtils: ==============================================================
22/05/12 09:03:48 INFO ResourceUtils: No custom resources configured for spark.driver.
22/05/12 09:03:48 INFO ResourceUtils: ==============================================================
22/05/12 09:03:48 INFO SparkContext: Submitted application: COM6012 Spark Intro
22/05/12 09:03:48 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
22/05/12 09:03:48 INFO ResourceProfile: Limiting resource is cpu
22/05/12 09:03:48 INFO ResourceProfileManager: Added ResourceProfile id: 0
22/05/12 09:03:48 INFO SecurityManager: Changing view acls to: acr21mp
22/05/12 09:03:48 INFO SecurityManager: Changing modify acls to: acr21mp
22/05/12 09:03:48 INFO SecurityManager: Changing view acls groups to: 
22/05/12 09:03:48 INFO SecurityManager: Changing modify acls groups to: 
22/05/12 09:03:48 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(acr21mp); groups with view permissions: Set(); users  with modify permissions: Set(acr21mp); groups with modify permissions: Set()
22/05/12 09:03:49 INFO Utils: Successfully started service 'sparkDriver' on port 46046.
22/05/12 09:03:49 INFO SparkEnv: Registering MapOutputTracker
22/05/12 09:03:49 INFO SparkEnv: Registering BlockManagerMaster
22/05/12 09:03:49 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
22/05/12 09:03:49 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
22/05/12 09:03:49 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
22/05/12 09:03:49 INFO DiskBlockManager: Created local directory at /mnt/fastdata/acr21mp/blockmgr-750ce1b8-3f70-4fff-ad6c-e1b042d342ff
22/05/12 09:03:49 INFO MemoryStore: MemoryStore started with capacity 10.5 GiB
22/05/12 09:03:49 INFO SparkEnv: Registering OutputCommitCoordinator
22/05/12 09:03:49 WARN Utils: Service 'SparkUI' could not bind on port 4040. Attempting port 4041.
22/05/12 09:03:49 WARN Utils: Service 'SparkUI' could not bind on port 4041. Attempting port 4042.
22/05/12 09:03:49 INFO Utils: Successfully started service 'SparkUI' on port 4042.
22/05/12 09:03:49 INFO SparkUI: Bound SparkUI to 0.0.0.0, and started at http://sharc-node174.shef.ac.uk:4042
22/05/12 09:03:49 INFO Executor: Starting executor ID driver on host sharc-node174.shef.ac.uk
22/05/12 09:03:49 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 44343.
22/05/12 09:03:49 INFO NettyBlockTransferService: Server created on sharc-node174.shef.ac.uk:44343
22/05/12 09:03:49 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
22/05/12 09:03:49 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, sharc-node174.shef.ac.uk, 44343, None)
22/05/12 09:03:49 INFO BlockManagerMasterEndpoint: Registering block manager sharc-node174.shef.ac.uk:44343 with 10.5 GiB RAM, BlockManagerId(driver, sharc-node174.shef.ac.uk, 44343, None)
22/05/12 09:03:49 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, sharc-node174.shef.ac.uk, 44343, None)
22/05/12 09:03:49 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, sharc-node174.shef.ac.uk, 44343, None)
/home/acr21mp/.conda/envs/myspark/lib/python3.6/site-packages/pyspark/python/lib/pyspark.zip/pyspark/context.py:238: FutureWarning: Python 3.6 support is deprecated in Spark 3.2.
  FutureWarning
22/05/12 09:03:50 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
22/05/12 09:03:50 INFO SharedState: Warehouse path is 'file:/data/acr21mp/ScalableML/Code/spark-warehouse'.
22/05/12 09:03:56 WARN package: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.sql.debug.maxToStringFields'.
root
 |-- _c0: double (nullable = true)
 |-- _c1: double (nullable = true)
 |-- _c2: double (nullable = true)
 |-- _c3: double (nullable = true)
 |-- _c4: double (nullable = true)
 |-- _c5: double (nullable = true)
 |-- _c6: double (nullable = true)
 |-- _c7: double (nullable = true)
 |-- _c8: double (nullable = true)
 |-- _c9: double (nullable = true)
 |-- _c10: double (nullable = true)
 |-- _c11: double (nullable = true)
 |-- _c12: double (nullable = true)
 |-- _c13: double (nullable = true)
 |-- _c14: double (nullable = true)
 |-- _c15: double (nullable = true)
 |-- _c16: double (nullable = true)
 |-- _c17: double (nullable = true)
 |-- _c18: double (nullable = true)
 |-- _c19: double (nullable = true)
 |-- _c20: double (nullable = true)
 |-- _c21: double (nullable = true)
 |-- _c22: double (nullable = true)
 |-- _c23: double (nullable = true)
 |-- _c24: double (nullable = true)
 |-- _c25: double (nullable = true)
 |-- _c26: double (nullable = true)
 |-- _c27: double (nullable = true)
 |-- _c28: double (nullable = true)
 |-- _c29: double (nullable = true)
 |-- _c30: double (nullable = true)
 |-- _c31: double (nullable = true)
 |-- _c32: double (nullable = true)
 |-- _c33: double (nullable = true)
 |-- _c34: double (nullable = true)
 |-- _c35: double (nullable = true)
 |-- _c36: double (nullable = true)
 |-- _c37: double (nullable = true)
 |-- _c38: double (nullable = true)
 |-- _c39: double (nullable = true)
 |-- _c40: double (nullable = true)
 |-- _c41: double (nullable = true)
 |-- _c42: double (nullable = true)
 |-- _c43: double (nullable = true)
 |-- _c44: double (nullable = true)
 |-- _c45: double (nullable = true)
 |-- _c46: double (nullable = true)
 |-- _c47: double (nullable = true)
 |-- _c48: double (nullable = true)
 |-- _c49: double (nullable = true)
 |-- _c50: double (nullable = true)
 |-- _c51: double (nullable = true)
 |-- _c52: double (nullable = true)
 |-- _c53: double (nullable = true)
 |-- _c54: double (nullable = true)
 |-- _c55: double (nullable = true)
 |-- _c56: double (nullable = true)
 |-- _c57: double (nullable = true)
 |-- _c58: double (nullable = true)
 |-- _c59: double (nullable = true)
 |-- _c60: double (nullable = true)
 |-- _c61: double (nullable = true)
 |-- _c62: double (nullable = true)
 |-- _c63: double (nullable = true)
 |-- _c64: double (nullable = true)
 |-- _c65: double (nullable = true)
 |-- _c66: double (nullable = true)
 |-- _c67: double (nullable = true)
 |-- _c68: double (nullable = true)
 |-- _c69: double (nullable = true)
 |-- _c70: double (nullable = true)
 |-- _c71: double (nullable = true)
 |-- _c72: double (nullable = true)
 |-- _c73: double (nullable = true)
 |-- _c74: double (nullable = true)
 |-- _c75: double (nullable = true)
 |-- _c76: double (nullable = true)
 |-- _c77: double (nullable = true)
 |-- _c78: double (nullable = true)
 |-- _c79: double (nullable = true)
 |-- _c80: double (nullable = true)
 |-- _c81: double (nullable = true)
 |-- _c82: double (nullable = true)
 |-- _c83: double (nullable = true)
 |-- _c84: double (nullable = true)
 |-- _c85: double (nullable = true)
 |-- _c86: double (nullable = true)
 |-- _c87: double (nullable = true)
 |-- _c88: double (nullable = true)
 |-- _c89: double (nullable = true)
 |-- _c90: double (nullable = true)
 |-- _c91: double (nullable = true)
 |-- _c92: double (nullable = true)
 |-- _c93: double (nullable = true)
 |-- _c94: double (nullable = true)
 |-- _c95: double (nullable = true)
 |-- _c96: double (nullable = true)
 |-- _c97: double (nullable = true)
 |-- _c98: double (nullable = true)
 |-- _c99: double (nullable = true)
 |-- _c100: double (nullable = true)
 |-- _c101: double (nullable = true)
 |-- _c102: double (nullable = true)
 |-- _c103: double (nullable = true)
 |-- _c104: double (nullable = true)
 |-- _c105: double (nullable = true)
 |-- _c106: double (nullable = true)
 |-- _c107: double (nullable = true)
 |-- _c108: double (nullable = true)
 |-- _c109: double (nullable = true)
 |-- _c110: double (nullable = true)
 |-- _c111: double (nullable = true)
 |-- _c112: double (nullable = true)
 |-- _c113: double (nullable = true)
 |-- _c114: double (nullable = true)
 |-- _c115: double (nullable = true)
 |-- _c116: double (nullable = true)
 |-- _c117: double (nullable = true)
 |-- _c118: double (nullable = true)
 |-- _c119: double (nullable = true)
 |-- _c120: double (nullable = true)
 |-- _c121: double (nullable = true)
 |-- _c122: double (nullable = true)
 |-- _c123: double (nullable = true)
 |-- _c124: double (nullable = true)
 |-- _c125: double (nullable = true)
 |-- _c126: double (nullable = true)
 |-- _c127: double (nullable = true)
 |-- labels: double (nullable = true)



+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+------+
| _c0| _c1| _c2| _c3| _c4| _c5| _c6| _c7| _c8| _c9|_c10|_c11|_c12|_c13|_c14|_c15|_c16|_c17|_c18|_c19|_c20|_c21|_c22|_c23|_c24|_c25|_c26|_c27|_c28|_c29|_c30|_c31|_c32|_c33|_c34|_c35|_c36|_c37|_c38|_c39|_c40|_c41|_c42|_c43|_c44|_c45|_c46|_c47|_c48|_c49|_c50|_c51|_c52|_c53|_c54|_c55|_c56|_c57|_c58|_c59|_c60|_c61|_c62|_c63|_c64|_c65|_c66|_c67|_c68|_c69|_c70|_c71|_c72|_c73|_c74|_c75|_c76|_c77|_c78|_c79|_c80|_c81|_c82|_c83|_c84|_c85|_c86|_c87|_c88|_c89|_c90|_c91|_c92|_c93|_c94|_c95|_c96|_c97|_c98|_c99|_c100|_c101|_c102|_c103|_c104|_c105|_c106|_c107|_c108|_c109|_c110|_c111|_c112|_c113|_c114|_c115|_c116|_c117|_c118|_c119|_c120|_c121|_c122|_c123|_c124|_c125|_c126|_c127|labels|
+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+------+
|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0| 1.0| 1.0| 1.0| 1.0| 1.0|-1.0| 1.0| 1.0| 1.0| 1.0|-1.0|-1.0| 1.0|-1.0|-1.0| 1.0| 1.0|-1.0| 1.0|-1.0| 1.0| 1.0| 1.0|-1.0| 1.0| 1.0| 1.0|-1.0|-1.0| 1.0| 1.0|-1.0| 1.0|-1.0|-1.0| 1.0| 1.0| 1.0| 1.0| 1.0| 1.0| 1.0| 1.0| 1.0|-1.0| 1.0|-1.0| 1.0| 1.0|-1.0| 1.0|-1.0| 1.0| 1.0|-1.0| 1.0| 1.0|-1.0| 1.0|-1.0|-1.0| 1.0| 1.0|-1.0| 1.0| 1.0| 1.0| 1.0| 1.0|-1.0|-1.0| 1.0|-1.0| 1.0| 1.0|-1.0|-1.0| 1.0|-1.0|-1.0|-1.0|-1.0| 1.0| 1.0|-1.0| 1.0| -1.0| -1.0| -1.0|  1.0| -1.0|  1.0|  1.0|  1.0| -1.0|  1.0|  1.0| -1.0| -1.0| -1.0| -1.0| -1.0| -1.0|  1.0|  1.0| -1.0| -1.0| -1.0|  1.0| -1.0|  1.0| -1.0| -1.0|  1.0|   0.0|
|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0| 1.0|-1.0|-1.0|-1.0| 1.0| 1.0|-1.0| 1.0|-1.0|-1.0| 1.0| 1.0|-1.0|-1.0|-1.0| 1.0| 1.0|-1.0|-1.0|-1.0|-1.0| 1.0|-1.0| 1.0| 1.0| 1.0| 1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0| 1.0|-1.0| 1.0| 1.0|-1.0|-1.0|-1.0|-1.0| 1.0|-1.0| 1.0|-1.0|-1.0|-1.0|-1.0| 1.0|-1.0|-1.0| 1.0| 1.0|-1.0|-1.0|-1.0|-1.0|-1.0| 1.0| 1.0|-1.0| 1.0|-1.0|-1.0|-1.0|-1.0| 1.0|-1.0|-1.0| 1.0|-1.0|-1.0| 1.0| 1.0|-1.0| 1.0| 1.0|-1.0| 1.0| 1.0| 1.0|-1.0| 1.0| 1.0| 1.0| 1.0| 1.0|-1.0| 1.0|-1.0| 1.0|  1.0|  1.0|  1.0| -1.0| -1.0| -1.0| -1.0|  1.0| -1.0| -1.0|  1.0| -1.0|  1.0|  1.0|  1.0| -1.0|  1.0|  1.0| -1.0|  1.0| -1.0|  1.0| -1.0|  1.0| -1.0|  1.0|  1.0| -1.0|   0.0|
|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0| 1.0|-1.0| 1.0| 1.0| 1.0| 1.0|-1.0|-1.0| 1.0|-1.0| 1.0| 1.0|-1.0| 1.0|-1.0|-1.0|-1.0| 1.0| 1.0| 1.0| 1.0| 1.0| 1.0|-1.0|-1.0| 1.0|-1.0|-1.0| 1.0|-1.0| 1.0|-1.0|-1.0| 1.0|-1.0| 1.0| 1.0| 1.0| 1.0|-1.0|-1.0|-1.0| 1.0| 1.0|-1.0| 1.0|-1.0|-1.0| 1.0| 1.0| 1.0| 1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0| 1.0|-1.0| 1.0| 1.0| 1.0| 1.0| 1.0| 1.0| 1.0|-1.0|-1.0|-1.0|-1.0|-1.0| 1.0| 1.0| 1.0| 1.0| 1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0| 1.0| 1.0| 1.0| 1.0|-1.0| 1.0|-1.0| 1.0|  1.0| -1.0|  1.0| -1.0|  1.0| -1.0|  1.0| -1.0| -1.0| -1.0|  1.0|  1.0|  1.0|  1.0| -1.0| -1.0|  1.0|  1.0|  1.0|  1.0| -1.0| -1.0|  1.0|  1.0| -1.0|  1.0|  1.0| -1.0|   0.0|
|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0| 1.0|-1.0|-1.0|-1.0|-1.0|-1.0| 1.0|-1.0|-1.0|-1.0|-1.0| 1.0|-1.0|-1.0|-1.0|-1.0|-1.0| 1.0| 1.0|-1.0| 1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0| 1.0| 1.0|-1.0| 1.0| 1.0|-1.0| 1.0| 1.0| 1.0|-1.0|-1.0| 1.0|-1.0| 1.0| 1.0| 1.0|-1.0|-1.0| 1.0|-1.0|-1.0| 1.0| 1.0|-1.0| 1.0|-1.0|-1.0|-1.0|-1.0| 1.0| 1.0|-1.0| 1.0| 1.0| 1.0|-1.0|-1.0|-1.0| 1.0| 1.0| 1.0|-1.0| 1.0|-1.0| 1.0| 1.0|-1.0| 1.0| 1.0|-1.0| 1.0| 1.0|-1.0|-1.0| 1.0| 1.0|-1.0|-1.0|-1.0|-1.0| 1.0| 1.0|-1.0|-1.0|-1.0| -1.0| -1.0| -1.0|  1.0| -1.0|  1.0| -1.0|  1.0|  1.0|  1.0| -1.0| -1.0|  1.0| -1.0|  1.0| -1.0|  1.0| -1.0| -1.0|  1.0| -1.0| -1.0|  1.0|  1.0|  1.0|  1.0|  1.0|  1.0|   0.0|
|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0| 1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0| 1.0| 1.0|-1.0| 1.0| 1.0| 1.0|-1.0| 1.0| 1.0|-1.0| 1.0| 1.0|-1.0| 1.0|-1.0|-1.0| 1.0|-1.0|-1.0|-1.0|-1.0| 1.0| 1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0| 1.0| 1.0|-1.0| 1.0|-1.0|-1.0|-1.0| 1.0| 1.0|-1.0| 1.0| 1.0| 1.0| 1.0|-1.0|-1.0| 1.0|-1.0| 1.0| 1.0|-1.0| 1.0|-1.0| 1.0| 1.0| 1.0|-1.0|-1.0| 1.0| 1.0| 1.0|-1.0| 1.0| 1.0|-1.0| 1.0|-1.0|-1.0|-1.0|-1.0| 1.0|-1.0|-1.0| 1.0| 1.0|-1.0|-1.0| 1.0| 1.0|-1.0| 1.0|-1.0| 1.0|  1.0| -1.0|  1.0|  1.0| -1.0| -1.0|  1.0| -1.0| -1.0| -1.0| -1.0| -1.0|  1.0| -1.0| -1.0| -1.0|  1.0|  1.0| -1.0|  1.0| -1.0| -1.0| -1.0|  1.0|  1.0| -1.0| -1.0| -1.0|   0.0|
+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+------+
only showing top 5 rows

1% of training data has - 34874
Vectorized training data -
+--------------------+------+
|            features|labels|
+--------------------+------+
|[-1.0,-1.0,-1.0,-...|   0.0|
|[-1.0,-1.0,-1.0,-...|   0.0|
|[-1.0,-1.0,-1.0,-...|   0.0|
|[-1.0,-1.0,-1.0,-...|   0.0|
|[-1.0,-1.0,-1.0,-...|   0.0|
+--------------------+------+
only showing top 5 rows

22/05/12 09:08:09 WARN DAGScheduler: Broadcasting large task binary with size 1761.7 KiB
22/05/12 09:08:10 WARN DAGScheduler: Broadcasting large task binary with size 1315.1 KiB
22/05/12 09:08:21 WARN DAGScheduler: Broadcasting large task binary with size 1761.7 KiB
22/05/12 09:08:23 WARN DAGScheduler: Broadcasting large task binary with size 1315.1 KiB
22/05/12 09:08:35 WARN DAGScheduler: Broadcasting large task binary with size 1761.7 KiB
22/05/12 09:08:36 WARN DAGScheduler: Broadcasting large task binary with size 1315.1 KiB
22/05/12 09:09:31 WARN DAGScheduler: Broadcasting large task binary with size 1761.6 KiB
22/05/12 09:09:33 WARN DAGScheduler: Broadcasting large task binary with size 1320.9 KiB
22/05/12 09:09:44 WARN DAGScheduler: Broadcasting large task binary with size 1761.6 KiB
22/05/12 09:09:45 WARN DAGScheduler: Broadcasting large task binary with size 1320.9 KiB
22/05/12 09:09:57 WARN DAGScheduler: Broadcasting large task binary with size 1761.6 KiB
22/05/12 09:09:58 WARN DAGScheduler: Broadcasting large task binary with size 1320.9 KiB
22/05/12 09:10:53 WARN DAGScheduler: Broadcasting large task binary with size 1761.8 KiB
22/05/12 09:10:54 WARN DAGScheduler: Broadcasting large task binary with size 1321.0 KiB
22/05/12 09:11:05 WARN DAGScheduler: Broadcasting large task binary with size 1761.8 KiB
22/05/12 09:11:06 WARN DAGScheduler: Broadcasting large task binary with size 1321.0 KiB
22/05/12 09:11:17 WARN DAGScheduler: Broadcasting large task binary with size 1761.8 KiB
22/05/12 09:11:19 WARN DAGScheduler: Broadcasting large task binary with size 1321.0 KiB
22/05/12 09:12:14 WARN DAGScheduler: Broadcasting large task binary with size 1762.2 KiB
22/05/12 09:12:15 WARN DAGScheduler: Broadcasting large task binary with size 1320.5 KiB
22/05/12 09:12:26 WARN DAGScheduler: Broadcasting large task binary with size 1762.2 KiB
22/05/12 09:12:28 WARN DAGScheduler: Broadcasting large task binary with size 1320.5 KiB
22/05/12 09:12:39 WARN DAGScheduler: Broadcasting large task binary with size 1762.2 KiB
22/05/12 09:12:40 WARN DAGScheduler: Broadcasting large task binary with size 1320.5 KiB
22/05/12 09:13:34 WARN DAGScheduler: Broadcasting large task binary with size 1761.9 KiB
22/05/12 09:13:36 WARN DAGScheduler: Broadcasting large task binary with size 1321.2 KiB
22/05/12 09:13:47 WARN DAGScheduler: Broadcasting large task binary with size 1761.9 KiB
22/05/12 09:13:49 WARN DAGScheduler: Broadcasting large task binary with size 1321.2 KiB
22/05/12 09:14:00 WARN DAGScheduler: Broadcasting large task binary with size 1761.9 KiB
22/05/12 09:14:01 WARN DAGScheduler: Broadcasting large task binary with size 1321.2 KiB
Hyper parameter tuning - RF model training time : 415.3822283744812s
Hyper parameter tuning - RF model testing time: 19.954442501068115s
Accuracy for best rf model = 0.500271 
Best Hyper parameters for random forest model are :
{
    "bootstrap": false,
    "cacheNodeIds": false,
    "checkpointInterval": 10,
    "featureSubsetStrategy": "auto",
    "featuresCol": "features",
    "impurity": "gini",
    "labelCol": "labels",
    "leafCol": "",
    "maxBins": 2,
    "maxDepth": 1,
    "maxMemoryInMB": 256,
    "minInfoGain": 0.0,
    "minInstancesPerNode": 1,
    "minWeightFractionPerNode": 0.0,
    "numTrees": 1,
    "predictionCol": "prediction",
    "probabilityCol": "probability",
    "rawPredictionCol": "rawPrediction",
    "seed": 1242,
    "subsamplingRate": 1.0
}
22/05/12 09:14:27 WARN InstanceBuilder$NativeBLAS: Failed to load implementation from:dev.ludovic.netlib.blas.JNIBLAS
22/05/12 09:14:27 WARN InstanceBuilder$NativeBLAS: Failed to load implementation from:dev.ludovic.netlib.blas.ForeignLinkerBLAS
Hyper parameter tuning - LR model training time : 261.0513844490051s
Hyper parameter tuning - LR model testing time : 8.522198677062988s
Accuracy for best log regress model = 0.498484 
Best Hyper parameters for logistic regression model are :
{
    "aggregationDepth": 2,
    "elasticNetParam": 1.0,
    "family": "binomial",
    "featuresCol": "features",
    "fitIntercept": true,
    "labelCol": "labels",
    "maxBlockSizeInMB": 0.0,
    "maxIter": 75,
    "predictionCol": "prediction",
    "probabilityCol": "probability",
    "rawPredictionCol": "rawPrediction",
    "regParam": 0.001,
    "standardization": true,
    "threshold": 0.5,
    "tol": 1e-06
}
22/05/12 09:18:55 WARN BLAS: Failed to load implementation from: com.github.fommil.netlib.NativeSystemBLAS
22/05/12 09:18:55 WARN BLAS: Failed to load implementation from: com.github.fommil.netlib.NativeRefBLAS
Hyper parameter tuning - NN model training time : 4084.7846841812134s
Hyper parameter tuning - NN model testing time : 9.163703680038452s
Accuracy for best Shallow NN model = 0.500234 
Best Hyper parameters for Shallow NN model are :
{
    "blockSize": 256,
    "featuresCol": "features",
    "labelCol": "labels",
    "maxIter": 150,
    "predictionCol": "prediction",
    "probabilityCol": "probability",
    "rawPredictionCol": "rawPrediction",
    "seed": 1500,
    "solver": "l-bfgs",
    "stepSize": 0.001,
    "tol": 1e-06,
    "layers": [
        128,
        20,
        5,
        2
    ]
}
Training time RF: 121.32711338996887s
Testing time RF: 0.1423358917236328s
Accuracy for fully trained rf model = 0.500049 
Area under ROC for RF model = 0.500049
Training time LR: 102.23597240447998s
Testing time LR: 0.1957716941833496s
Accuracy for fully trained LR model = 0.499462 
Area under ROC for LR model = 0.5
Training time NN: 1430.257886648178s
Testing time NN: 0.1402597427368164s
Accuracy for fully trained NN model = 0.500379 
Area under ROC for NN model = 0.500366

Output for 10 cores

Conda uses environments to load different sets of Python packages
type conda env list to see the environments availible.
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
22/05/12 09:05:11 INFO SparkContext: Running Spark version 3.2.1
22/05/12 09:05:11 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
22/05/12 09:05:11 WARN SparkConf: Note that spark.local.dir will be overridden by the value set by the cluster manager (via SPARK_LOCAL_DIRS in mesos/standalone/kubernetes and LOCAL_DIRS in YARN).
22/05/12 09:05:11 INFO ResourceUtils: ==============================================================
22/05/12 09:05:11 INFO ResourceUtils: No custom resources configured for spark.driver.
22/05/12 09:05:11 INFO ResourceUtils: ==============================================================
22/05/12 09:05:11 INFO SparkContext: Submitted application: COM6012 Spark Intro
22/05/12 09:05:11 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
22/05/12 09:05:11 INFO ResourceProfile: Limiting resource is cpu
22/05/12 09:05:11 INFO ResourceProfileManager: Added ResourceProfile id: 0
22/05/12 09:05:11 INFO SecurityManager: Changing view acls to: acr21mp
22/05/12 09:05:11 INFO SecurityManager: Changing modify acls to: acr21mp
22/05/12 09:05:11 INFO SecurityManager: Changing view acls groups to: 
22/05/12 09:05:11 INFO SecurityManager: Changing modify acls groups to: 
22/05/12 09:05:11 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(acr21mp); groups with view permissions: Set(); users  with modify permissions: Set(acr21mp); groups with modify permissions: Set()
22/05/12 09:05:11 INFO Utils: Successfully started service 'sparkDriver' on port 46716.
22/05/12 09:05:11 INFO SparkEnv: Registering MapOutputTracker
22/05/12 09:05:11 INFO SparkEnv: Registering BlockManagerMaster
22/05/12 09:05:11 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
22/05/12 09:05:11 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
22/05/12 09:05:11 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
22/05/12 09:05:11 INFO DiskBlockManager: Created local directory at /mnt/fastdata/acr21mp/blockmgr-aa0224cb-8950-4860-b9d3-f4c804cbb923
22/05/12 09:05:11 INFO MemoryStore: MemoryStore started with capacity 10.5 GiB
22/05/12 09:05:11 INFO SparkEnv: Registering OutputCommitCoordinator
22/05/12 09:05:12 WARN Utils: Service 'SparkUI' could not bind on port 4040. Attempting port 4041.
22/05/12 09:05:12 WARN Utils: Service 'SparkUI' could not bind on port 4041. Attempting port 4042.
22/05/12 09:05:12 INFO Utils: Successfully started service 'SparkUI' on port 4042.
22/05/12 09:05:12 INFO SparkUI: Bound SparkUI to 0.0.0.0, and started at http://sharc-node173.shef.ac.uk:4042
22/05/12 09:05:12 INFO Executor: Starting executor ID driver on host sharc-node173.shef.ac.uk
22/05/12 09:05:12 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 41773.
22/05/12 09:05:12 INFO NettyBlockTransferService: Server created on sharc-node173.shef.ac.uk:41773
22/05/12 09:05:12 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
22/05/12 09:05:12 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, sharc-node173.shef.ac.uk, 41773, None)
22/05/12 09:05:12 INFO BlockManagerMasterEndpoint: Registering block manager sharc-node173.shef.ac.uk:41773 with 10.5 GiB RAM, BlockManagerId(driver, sharc-node173.shef.ac.uk, 41773, None)
22/05/12 09:05:12 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, sharc-node173.shef.ac.uk, 41773, None)
22/05/12 09:05:12 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, sharc-node173.shef.ac.uk, 41773, None)
/home/acr21mp/.conda/envs/myspark/lib/python3.6/site-packages/pyspark/python/lib/pyspark.zip/pyspark/context.py:238: FutureWarning: Python 3.6 support is deprecated in Spark 3.2.
  FutureWarning
22/05/12 09:05:13 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
22/05/12 09:05:13 INFO SharedState: Warehouse path is 'file:/data/acr21mp/ScalableML/Code/spark-warehouse'.
22/05/12 09:05:18 WARN package: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.sql.debug.maxToStringFields'.
root
 |-- _c0: double (nullable = true)
 |-- _c1: double (nullable = true)
 |-- _c2: double (nullable = true)
 |-- _c3: double (nullable = true)
 |-- _c4: double (nullable = true)
 |-- _c5: double (nullable = true)
 |-- _c6: double (nullable = true)
 |-- _c7: double (nullable = true)
 |-- _c8: double (nullable = true)
 |-- _c9: double (nullable = true)
 |-- _c10: double (nullable = true)
 |-- _c11: double (nullable = true)
 |-- _c12: double (nullable = true)
 |-- _c13: double (nullable = true)
 |-- _c14: double (nullable = true)
 |-- _c15: double (nullable = true)
 |-- _c16: double (nullable = true)
 |-- _c17: double (nullable = true)
 |-- _c18: double (nullable = true)
 |-- _c19: double (nullable = true)
 |-- _c20: double (nullable = true)
 |-- _c21: double (nullable = true)
 |-- _c22: double (nullable = true)
 |-- _c23: double (nullable = true)
 |-- _c24: double (nullable = true)
 |-- _c25: double (nullable = true)
 |-- _c26: double (nullable = true)
 |-- _c27: double (nullable = true)
 |-- _c28: double (nullable = true)
 |-- _c29: double (nullable = true)
 |-- _c30: double (nullable = true)
 |-- _c31: double (nullable = true)
 |-- _c32: double (nullable = true)
 |-- _c33: double (nullable = true)
 |-- _c34: double (nullable = true)
 |-- _c35: double (nullable = true)
 |-- _c36: double (nullable = true)
 |-- _c37: double (nullable = true)
 |-- _c38: double (nullable = true)
 |-- _c39: double (nullable = true)
 |-- _c40: double (nullable = true)
 |-- _c41: double (nullable = true)
 |-- _c42: double (nullable = true)
 |-- _c43: double (nullable = true)
 |-- _c44: double (nullable = true)
 |-- _c45: double (nullable = true)
 |-- _c46: double (nullable = true)
 |-- _c47: double (nullable = true)
 |-- _c48: double (nullable = true)
 |-- _c49: double (nullable = true)
 |-- _c50: double (nullable = true)
 |-- _c51: double (nullable = true)
 |-- _c52: double (nullable = true)
 |-- _c53: double (nullable = true)
 |-- _c54: double (nullable = true)
 |-- _c55: double (nullable = true)
 |-- _c56: double (nullable = true)
 |-- _c57: double (nullable = true)
 |-- _c58: double (nullable = true)
 |-- _c59: double (nullable = true)
 |-- _c60: double (nullable = true)
 |-- _c61: double (nullable = true)
 |-- _c62: double (nullable = true)
 |-- _c63: double (nullable = true)
 |-- _c64: double (nullable = true)
 |-- _c65: double (nullable = true)
 |-- _c66: double (nullable = true)
 |-- _c67: double (nullable = true)
 |-- _c68: double (nullable = true)
 |-- _c69: double (nullable = true)
 |-- _c70: double (nullable = true)
 |-- _c71: double (nullable = true)
 |-- _c72: double (nullable = true)
 |-- _c73: double (nullable = true)
 |-- _c74: double (nullable = true)
 |-- _c75: double (nullable = true)
 |-- _c76: double (nullable = true)
 |-- _c77: double (nullable = true)
 |-- _c78: double (nullable = true)
 |-- _c79: double (nullable = true)
 |-- _c80: double (nullable = true)
 |-- _c81: double (nullable = true)
 |-- _c82: double (nullable = true)
 |-- _c83: double (nullable = true)
 |-- _c84: double (nullable = true)
 |-- _c85: double (nullable = true)
 |-- _c86: double (nullable = true)
 |-- _c87: double (nullable = true)
 |-- _c88: double (nullable = true)
 |-- _c89: double (nullable = true)
 |-- _c90: double (nullable = true)
 |-- _c91: double (nullable = true)
 |-- _c92: double (nullable = true)
 |-- _c93: double (nullable = true)
 |-- _c94: double (nullable = true)
 |-- _c95: double (nullable = true)
 |-- _c96: double (nullable = true)
 |-- _c97: double (nullable = true)
 |-- _c98: double (nullable = true)
 |-- _c99: double (nullable = true)
 |-- _c100: double (nullable = true)
 |-- _c101: double (nullable = true)
 |-- _c102: double (nullable = true)
 |-- _c103: double (nullable = true)
 |-- _c104: double (nullable = true)
 |-- _c105: double (nullable = true)
 |-- _c106: double (nullable = true)
 |-- _c107: double (nullable = true)
 |-- _c108: double (nullable = true)
 |-- _c109: double (nullable = true)
 |-- _c110: double (nullable = true)
 |-- _c111: double (nullable = true)
 |-- _c112: double (nullable = true)
 |-- _c113: double (nullable = true)
 |-- _c114: double (nullable = true)
 |-- _c115: double (nullable = true)
 |-- _c116: double (nullable = true)
 |-- _c117: double (nullable = true)
 |-- _c118: double (nullable = true)
 |-- _c119: double (nullable = true)
 |-- _c120: double (nullable = true)
 |-- _c121: double (nullable = true)
 |-- _c122: double (nullable = true)
 |-- _c123: double (nullable = true)
 |-- _c124: double (nullable = true)
 |-- _c125: double (nullable = true)
 |-- _c126: double (nullable = true)
 |-- _c127: double (nullable = true)
 |-- labels: double (nullable = true)



+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+------+
| _c0| _c1| _c2| _c3| _c4| _c5| _c6| _c7| _c8| _c9|_c10|_c11|_c12|_c13|_c14|_c15|_c16|_c17|_c18|_c19|_c20|_c21|_c22|_c23|_c24|_c25|_c26|_c27|_c28|_c29|_c30|_c31|_c32|_c33|_c34|_c35|_c36|_c37|_c38|_c39|_c40|_c41|_c42|_c43|_c44|_c45|_c46|_c47|_c48|_c49|_c50|_c51|_c52|_c53|_c54|_c55|_c56|_c57|_c58|_c59|_c60|_c61|_c62|_c63|_c64|_c65|_c66|_c67|_c68|_c69|_c70|_c71|_c72|_c73|_c74|_c75|_c76|_c77|_c78|_c79|_c80|_c81|_c82|_c83|_c84|_c85|_c86|_c87|_c88|_c89|_c90|_c91|_c92|_c93|_c94|_c95|_c96|_c97|_c98|_c99|_c100|_c101|_c102|_c103|_c104|_c105|_c106|_c107|_c108|_c109|_c110|_c111|_c112|_c113|_c114|_c115|_c116|_c117|_c118|_c119|_c120|_c121|_c122|_c123|_c124|_c125|_c126|_c127|labels|
+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+------+
|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0| 1.0| 1.0| 1.0| 1.0| 1.0|-1.0| 1.0| 1.0| 1.0| 1.0|-1.0|-1.0| 1.0|-1.0|-1.0| 1.0| 1.0|-1.0| 1.0|-1.0| 1.0| 1.0| 1.0|-1.0| 1.0| 1.0| 1.0|-1.0|-1.0| 1.0| 1.0|-1.0| 1.0|-1.0|-1.0| 1.0| 1.0| 1.0| 1.0| 1.0| 1.0| 1.0| 1.0| 1.0|-1.0| 1.0|-1.0| 1.0| 1.0|-1.0| 1.0|-1.0| 1.0| 1.0|-1.0| 1.0| 1.0|-1.0| 1.0|-1.0|-1.0| 1.0| 1.0|-1.0| 1.0| 1.0| 1.0| 1.0| 1.0|-1.0|-1.0| 1.0|-1.0| 1.0| 1.0|-1.0|-1.0| 1.0|-1.0|-1.0|-1.0|-1.0| 1.0| 1.0|-1.0| 1.0| -1.0| -1.0| -1.0|  1.0| -1.0|  1.0|  1.0|  1.0| -1.0|  1.0|  1.0| -1.0| -1.0| -1.0| -1.0| -1.0| -1.0|  1.0|  1.0| -1.0| -1.0| -1.0|  1.0| -1.0|  1.0| -1.0| -1.0|  1.0|   0.0|
|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0| 1.0|-1.0|-1.0|-1.0| 1.0| 1.0|-1.0| 1.0|-1.0|-1.0| 1.0| 1.0|-1.0|-1.0|-1.0| 1.0| 1.0|-1.0|-1.0|-1.0|-1.0| 1.0|-1.0| 1.0| 1.0| 1.0| 1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0| 1.0|-1.0| 1.0| 1.0|-1.0|-1.0|-1.0|-1.0| 1.0|-1.0| 1.0|-1.0|-1.0|-1.0|-1.0| 1.0|-1.0|-1.0| 1.0| 1.0|-1.0|-1.0|-1.0|-1.0|-1.0| 1.0| 1.0|-1.0| 1.0|-1.0|-1.0|-1.0|-1.0| 1.0|-1.0|-1.0| 1.0|-1.0|-1.0| 1.0| 1.0|-1.0| 1.0| 1.0|-1.0| 1.0| 1.0| 1.0|-1.0| 1.0| 1.0| 1.0| 1.0| 1.0|-1.0| 1.0|-1.0| 1.0|  1.0|  1.0|  1.0| -1.0| -1.0| -1.0| -1.0|  1.0| -1.0| -1.0|  1.0| -1.0|  1.0|  1.0|  1.0| -1.0|  1.0|  1.0| -1.0|  1.0| -1.0|  1.0| -1.0|  1.0| -1.0|  1.0|  1.0| -1.0|   0.0|
|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0| 1.0|-1.0| 1.0| 1.0| 1.0| 1.0|-1.0|-1.0| 1.0|-1.0| 1.0| 1.0|-1.0| 1.0|-1.0|-1.0|-1.0| 1.0| 1.0| 1.0| 1.0| 1.0| 1.0|-1.0|-1.0| 1.0|-1.0|-1.0| 1.0|-1.0| 1.0|-1.0|-1.0| 1.0|-1.0| 1.0| 1.0| 1.0| 1.0|-1.0|-1.0|-1.0| 1.0| 1.0|-1.0| 1.0|-1.0|-1.0| 1.0| 1.0| 1.0| 1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0| 1.0|-1.0| 1.0| 1.0| 1.0| 1.0| 1.0| 1.0| 1.0|-1.0|-1.0|-1.0|-1.0|-1.0| 1.0| 1.0| 1.0| 1.0| 1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0| 1.0| 1.0| 1.0| 1.0|-1.0| 1.0|-1.0| 1.0|  1.0| -1.0|  1.0| -1.0|  1.0| -1.0|  1.0| -1.0| -1.0| -1.0|  1.0|  1.0|  1.0|  1.0| -1.0| -1.0|  1.0|  1.0|  1.0|  1.0| -1.0| -1.0|  1.0|  1.0| -1.0|  1.0|  1.0| -1.0|   0.0|
|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0| 1.0|-1.0|-1.0|-1.0|-1.0|-1.0| 1.0|-1.0|-1.0|-1.0|-1.0| 1.0|-1.0|-1.0|-1.0|-1.0|-1.0| 1.0| 1.0|-1.0| 1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0| 1.0| 1.0|-1.0| 1.0| 1.0|-1.0| 1.0| 1.0| 1.0|-1.0|-1.0| 1.0|-1.0| 1.0| 1.0| 1.0|-1.0|-1.0| 1.0|-1.0|-1.0| 1.0| 1.0|-1.0| 1.0|-1.0|-1.0|-1.0|-1.0| 1.0| 1.0|-1.0| 1.0| 1.0| 1.0|-1.0|-1.0|-1.0| 1.0| 1.0| 1.0|-1.0| 1.0|-1.0| 1.0| 1.0|-1.0| 1.0| 1.0|-1.0| 1.0| 1.0|-1.0|-1.0| 1.0| 1.0|-1.0|-1.0|-1.0|-1.0| 1.0| 1.0|-1.0|-1.0|-1.0| -1.0| -1.0| -1.0|  1.0| -1.0|  1.0| -1.0|  1.0|  1.0|  1.0| -1.0| -1.0|  1.0| -1.0|  1.0| -1.0|  1.0| -1.0| -1.0|  1.0| -1.0| -1.0|  1.0|  1.0|  1.0|  1.0|  1.0|  1.0|   0.0|
|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0| 1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0| 1.0| 1.0|-1.0| 1.0| 1.0| 1.0|-1.0| 1.0| 1.0|-1.0| 1.0| 1.0|-1.0| 1.0|-1.0|-1.0| 1.0|-1.0|-1.0|-1.0|-1.0| 1.0| 1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0|-1.0| 1.0| 1.0|-1.0| 1.0|-1.0|-1.0|-1.0| 1.0| 1.0|-1.0| 1.0| 1.0| 1.0| 1.0|-1.0|-1.0| 1.0|-1.0| 1.0| 1.0|-1.0| 1.0|-1.0| 1.0| 1.0| 1.0|-1.0|-1.0| 1.0| 1.0| 1.0|-1.0| 1.0| 1.0|-1.0| 1.0|-1.0|-1.0|-1.0|-1.0| 1.0|-1.0|-1.0| 1.0| 1.0|-1.0|-1.0| 1.0| 1.0|-1.0| 1.0|-1.0| 1.0|  1.0| -1.0|  1.0|  1.0| -1.0| -1.0|  1.0| -1.0| -1.0| -1.0| -1.0| -1.0|  1.0| -1.0| -1.0| -1.0|  1.0|  1.0| -1.0|  1.0| -1.0| -1.0| -1.0|  1.0|  1.0| -1.0| -1.0| -1.0|   0.0|
+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+------+
only showing top 5 rows

1% of training data has - 34874
Vectorized training data -
+--------------------+------+
|            features|labels|
+--------------------+------+
|[-1.0,-1.0,-1.0,-...|   0.0|
|[-1.0,-1.0,-1.0,-...|   0.0|
|[-1.0,-1.0,-1.0,-...|   0.0|
|[-1.0,-1.0,-1.0,-...|   0.0|
|[-1.0,-1.0,-1.0,-...|   0.0|
+--------------------+------+
only showing top 5 rows

22/05/12 09:08:31 WARN DAGScheduler: Broadcasting large task binary with size 1761.7 KiB
22/05/12 09:08:33 WARN DAGScheduler: Broadcasting large task binary with size 1315.2 KiB
22/05/12 09:08:43 WARN DAGScheduler: Broadcasting large task binary with size 1761.7 KiB
22/05/12 09:08:44 WARN DAGScheduler: Broadcasting large task binary with size 1315.2 KiB
22/05/12 09:08:54 WARN DAGScheduler: Broadcasting large task binary with size 1761.7 KiB
22/05/12 09:08:55 WARN DAGScheduler: Broadcasting large task binary with size 1315.2 KiB
22/05/12 09:09:46 WARN DAGScheduler: Broadcasting large task binary with size 1761.6 KiB
22/05/12 09:09:47 WARN DAGScheduler: Broadcasting large task binary with size 1320.9 KiB
22/05/12 09:09:57 WARN DAGScheduler: Broadcasting large task binary with size 1761.6 KiB
22/05/12 09:09:58 WARN DAGScheduler: Broadcasting large task binary with size 1320.9 KiB
22/05/12 09:10:08 WARN DAGScheduler: Broadcasting large task binary with size 1761.6 KiB
22/05/12 09:10:10 WARN DAGScheduler: Broadcasting large task binary with size 1320.9 KiB
22/05/12 09:10:59 WARN DAGScheduler: Broadcasting large task binary with size 1761.8 KiB
22/05/12 09:11:01 WARN DAGScheduler: Broadcasting large task binary with size 1321.0 KiB
22/05/12 09:11:11 WARN DAGScheduler: Broadcasting large task binary with size 1761.8 KiB
22/05/12 09:11:12 WARN DAGScheduler: Broadcasting large task binary with size 1321.0 KiB
22/05/12 09:11:22 WARN DAGScheduler: Broadcasting large task binary with size 1761.8 KiB
22/05/12 09:11:23 WARN DAGScheduler: Broadcasting large task binary with size 1321.0 KiB
22/05/12 09:12:12 WARN DAGScheduler: Broadcasting large task binary with size 1762.2 KiB
22/05/12 09:12:13 WARN DAGScheduler: Broadcasting large task binary with size 1320.5 KiB
22/05/12 09:12:23 WARN DAGScheduler: Broadcasting large task binary with size 1762.2 KiB
22/05/12 09:12:24 WARN DAGScheduler: Broadcasting large task binary with size 1320.5 KiB
22/05/12 09:12:34 WARN DAGScheduler: Broadcasting large task binary with size 1762.2 KiB
22/05/12 09:12:35 WARN DAGScheduler: Broadcasting large task binary with size 1320.5 KiB
22/05/12 09:13:24 WARN DAGScheduler: Broadcasting large task binary with size 1761.9 KiB
22/05/12 09:13:25 WARN DAGScheduler: Broadcasting large task binary with size 1321.2 KiB
22/05/12 09:13:35 WARN DAGScheduler: Broadcasting large task binary with size 1761.9 KiB
22/05/12 09:13:36 WARN DAGScheduler: Broadcasting large task binary with size 1321.2 KiB
22/05/12 09:13:46 WARN DAGScheduler: Broadcasting large task binary with size 1761.9 KiB
22/05/12 09:13:47 WARN DAGScheduler: Broadcasting large task binary with size 1321.2 KiB
Hyper parameter tuning - RF model training time : 371.5951404571533s
Hyper parameter tuning - RF model testing time: 11.661166191101074s
Accuracy for best rf model = 0.500271 
Best Hyper parameters for random forest model are :
{
    "bootstrap": false,
    "cacheNodeIds": false,
    "checkpointInterval": 10,
    "featureSubsetStrategy": "auto",
    "featuresCol": "features",
    "impurity": "gini",
    "labelCol": "labels",
    "leafCol": "",
    "maxBins": 2,
    "maxDepth": 1,
    "maxMemoryInMB": 256,
    "minInfoGain": 0.0,
    "minInstancesPerNode": 1,
    "minWeightFractionPerNode": 0.0,
    "numTrees": 1,
    "predictionCol": "prediction",
    "probabilityCol": "probability",
    "rawPredictionCol": "rawPrediction",
    "seed": 1242,
    "subsamplingRate": 1.0
}
22/05/12 09:14:02 WARN InstanceBuilder$NativeBLAS: Failed to load implementation from:dev.ludovic.netlib.blas.JNIBLAS
22/05/12 09:14:02 WARN InstanceBuilder$NativeBLAS: Failed to load implementation from:dev.ludovic.netlib.blas.ForeignLinkerBLAS
Hyper parameter tuning - LR model training time : 248.6177113056183s
Hyper parameter tuning - LR model testing time : 5.783892393112183s
Accuracy for best log regress model = 0.498484 
Best Hyper parameters for logistic regression model are :
{
    "aggregationDepth": 2,
    "elasticNetParam": 1.0,
    "family": "binomial",
    "featuresCol": "features",
    "fitIntercept": true,
    "labelCol": "labels",
    "maxBlockSizeInMB": 0.0,
    "maxIter": 75,
    "predictionCol": "prediction",
    "probabilityCol": "probability",
    "rawPredictionCol": "rawPrediction",
    "regParam": 0.001,
    "standardization": true,
    "threshold": 0.5,
    "tol": 1e-06
}
22/05/12 09:18:17 WARN BLAS: Failed to load implementation from: com.github.fommil.netlib.NativeSystemBLAS
22/05/12 09:18:17 WARN BLAS: Failed to load implementation from: com.github.fommil.netlib.NativeRefBLAS
Hyper parameter tuning - NN model training time : 4030.8221487998962s
Hyper parameter tuning - NN model testing time : 5.270482301712036s
Accuracy for best Shallow NN model = 0.500287 
Best Hyper parameters for Shallow NN model are :
{
    "blockSize": 256,
    "featuresCol": "features",
    "labelCol": "labels",
    "maxIter": 75,
    "predictionCol": "prediction",
    "probabilityCol": "probability",
    "rawPredictionCol": "rawPrediction",
    "seed": 1500,
    "solver": "l-bfgs",
    "stepSize": 0.1,
    "tol": 1e-06,
    "layers": [
        128,
        20,
        40,
        2
    ]
}
Training time RF: 84.00568509101868s
Testing time RF: 0.15816736221313477s
Accuracy for fully trained rf model = 0.500049 
Area under ROC for RF model = 0.500049
Training time LR: 73.12712216377258s
Testing time LR: 0.14100050926208496s
Accuracy for fully trained LR model = 0.499462 
Area under ROC for LR model = 0.5
Training time NN: 913.9693424701691s
Testing time NN: 0.1506507396697998s
Accuracy for fully trained NN model = 0.500111 
Area under ROC for NN model = 0.500106
